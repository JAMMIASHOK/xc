% File: ~/OOP/analysis/model/fe_ele/lagrange/LagrangeSFreedom_FE.tex 
%What: "@(#) LagrangeSFreedom_FE.tex, revA"

\noindent {\bf Files}
\indent \#include \f$<\tilde{ }\f$/analysis/fe\_ele/lagrange/LagrangeSFreedom\_FE.h\f$>\f$

\noindent {\bf Class Declaration}
\indent class LagrangeSFreedom\_FE: public FE\_Element ;

\noindent {\bf Class Hierarchy}
\indent FE\_Element
\indent\indent {\bf LagrangeSFreedom\_FE} 

\noindent {\bf Description}
\indent LagrangeSFreedom\_FE is a subclass of FE\_Element used to enforce a
//! single point constraint. It does this by adding to the tangent and the
//! residual:
\[ \left[ \begin{array}{cc} 0 & \alpha \alpha & 0 \end{array}
\right] ,
\left\{ \begin{array}{c} 0 \alpha(u_s - u_t) \end{array} \right\} \]
\noindent at the locations
//! corresponding to the constrained degree-of-freedom specified by the
//! SFreedom\_Constraint and the lagrange multiplier degree-of-freedom
//! introduced by the LagrangeConstraintHandler for this constraint, where
\f$U_s\f$ is the specified value of the constraint 
//! and \f$U_t\f$ the current trial displacement at the node corresponding to
//! the constraint.

\noindent {\bf Class Interface}
\indent\indent // Constructor
\indent\indent {\em LagrangeSFreedom\_FE(Domain \&theDomain, SFreedom\_Constraint
\&theSP, DOF\_Group \&theGroup, double alpha = 1.0);}
\indent\indent // Destructor
\indent\indent {\em virtual~ \f$\tilde{}\f$LagrangeSFreedom\_FE();}
\indent\indent // Public Methods
\indent\indent {\em virtual void setID(void);}  
\indent\indent {\em virtual const Matrix \&getTangent(Integrator
*theIntegrator);}  
\indent\indent {\em virtual const Vector \&getResidual(Integrator
*theIntegrator);}  
\indent\indent {\em virtual const Vector \&getTangForce(const Vector
\&disp, double fact = 1.0);    }

\noindent {\bf Constructor}
\indent {\em LagrangeSFreedom\_FE(Domain \&theDomain, SFreedom\_Constraint \&theSP,
//! DOF\_Group \&theGroup, double alpha = 1.0);}
//! To construct a LagrangeSFreedom\_FE element to enforce the constraint
//! specified by the SFreedom\_Constraint \p theSP using a value for
\f$\alpha\f$ of \p alpha (which, if none is specified, defaults to
\f$1.0\f$). The FE\_Element class constructor is called with 
//! the integers \f$2\f$ and \f$2\f$. A Matrix and a Vector object of order \f$2\f$
//! are created to return the tangent and residual contributions, with the
//! tangent entries (0,1) and (1,0) set at \f$\alpha\f$. A link to the Node in the Domain
//! corresponding to the SFreedom\_Constraint is also set. A warning message is
//! printed and program terminates if there is not enough memory or no
//! Node associated with the SFreedom\_Constraint exists in the Domain, or
//! DOF\_Group is associated with the Node.

\noindent {\bf Destructor}
\indent {\em virtual~ \f$\tilde{}\f$LagrangeSFreedom\_FE();}
//! Invokes the destructor on the Matrix and Vector objects created in the
//! constructor.

\noindent {\bf Public Methods}
\indent {\em virtual void setID(void);}
//! Causes the LagrangeSFreedom\_FE to determine the mapping between it's equation
//! numbers and the degrees-of-freedom. From the Node object link, created
//! in the constructor, the DOF\_group corresponding to the Node
//! associated with the constraint is determined. From this {\em
//! DOF\_Group} object the mapping for the constrained degree of freedom
//! is determined and the myID(0) in the base class is set. The myID(1) is
//! determined from the Lagrange DOF\_Group \p theGroup passed in the
//! constructor. Returns \f$0\f$ if 
//! successful. Prints a warning message and returns a negative number if
//! an error occurs: \f$-2\f$ if the
//! Node has no associated DOF\_Group, \f$-3\f$ if the constrained DOF
//! specified is invalid for this Node and \f$-4\f$ if the ID in the
//! DOF\_Group is too small for the Node. 

\indent {\em virtual const Matrix \&getTangent(Integrator *theIntegrator);}
//! Returns the tangent Matrix created in the constructor.

\indent {\em virtual const Vector \&getResidual(Integrator *theIntegrator);}
//! Sets the FE\_Elements contribution to the residual:
\[ \left\{ \begin{array}{c} 0 \alpha(u_s - u_t) \end{array} \right\} \]
//! where \f$U_s\f$ is the specified value of the
//! constraint and \f$U_t\f$ the current trial displacement at the node
//! corresponding to constrained degree-of-freedom. Prints a warning
//! message and sets this contribution to \f$0\f$ if the specified constrained
//! degree-of-freedom is invalid. Returns this residual Vector.


{\em virtual const Vector \&getTangForce(const Vector \&disp, double
//! fact = 1.0);    }
//! Sets the FE\_Elements contribution to the residual:
\[ \left\{ \begin{array}{c} 0 \alpha(u_s - u_t) \end{array} \right\} \]
//! where \f$U_s\f$ is the specified value of the
//! constraint and \f$U_t\f$ the current trial displacement in \p disp
//! corresponding to constrained degree-of-freedom. Prints a warning
//! message and sets this contribution to \f$0\f$ if the specified constrained
//! degree-of-freedom is invalid. 










